<!DOCTYPE HTML>
<div>
<script type="text/javascript" async="" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
</div>

<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>MATH1120 Sage Playground</title>
    <script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script>
    <script>
    // Make the div with id 'mycell' a Sage cell
    sagecell.makeSagecell({inputLocation:  '#mycell',
                           template:       sagecell.templates.minimal,
                           evalButtonText: 'Activate'});
    // Make *any* div with class 'compute' a Sage cell
    sagecell.makeSagecell({inputLocation: 'div.compute',
                           evalButtonText: 'Evaluate'});
    </script>
  </head>
  <body>


  <h1>Sage Playground for MATH1120</h1>

  SageMath is a powerful open source mathematics package used by actual researchers.<br>

  You can download SageMath <a href="https://www.sagemath.org/">here</a>.<br>

  You can also just run Sage commands online, on this page or on the
  <a href="https://sagecell.sagemath.org/">Sage Cell Server</a>.<br>

  Sage <a href="https://doc.sagemath.org/html/en/tutorial/index.html">Tutorials</a> and documentation are
  <a href="https://doc.sagemath.org/">here</a>.<br>

<!--
  <h2>Factorial</h2>
  Click the &ldquo;Activate&rdquo; button below to calculate factorials.

<div id="mycell"><script type="text/x-sage">
@interact
def _(a=(1, 10)):
    print(factorial(a))
 </script>
</div>
-->

<h2>Calculus III : Functions of Several Variables</h2>


<b>3D plots of functions we saw in class:</b><br><br>

\(f(x,y)=xy\):<br>
<div class="compute"><script type="text/x-sage">
x,y=var('x','y')
f=x*y
Mx=1
My=1
plot3d(f,(x,-Mx,Mx),(y,-My,My))
</script></div>

<br>
The sombrero:
\(f(x,y)=1-\sqrt{x^2+y^2}e^{-(x^2+y^2)}\):<br>
<div class="compute"><script type="text/x-sage">
x,y=var('x','y')
f=1-sqrt(x^2+y^2)*exp(-x^2-y^2)
Mx=1
My=1
plot3d(f,(x,-Mx,Mx),(y,-My,My))
</script></div>

<br>
Now we plot both the 3D graph and a contour plot:<br>
\( f(x,y)=\sin(y)e^{x/5}\)<br>
<div class="compute"><script type="text/x-sage">
x,y=var('x','y')
f=sin(y)*exp(x/5)
Mx=10
My=10
show(plot3d(f,(x,-Mx,Mx),(y,-My,My)),plot_points=500,adaptive=true)
show(contour_plot(f,(x,-Mx,Mx),(y,-My,My),colorbar=True,labels=True,contours=30,plot_points=500))
</script></div>

<h2>Calculus V : Tangent Planes</h2>

Play with linear approximations<br>
<div class="compute"><script type="text/x-sage">
x,y=var('x','y')

#f = 5-(x^2+y^2)/2
f = x*y

Mx=3
My=3
fx=diff(f,x)
fy=diff(f,y)
show('f(x,y)='+latex(f(x=x,y=y)))
show(r'f_x=\frac{\partial f}{\partial x} = '+latex(fx))
show(r'f_y=\frac{\partial f}{\partial y} = '+latex(fy))

@interact
def _(x0=slider(-Mx,Mx,step_size=0.1),y0=slider(-My,My,step_size=0.1),auto_update=False):
    L = f(x=x0,y=y0)+fx(x=x0,y=y0)*(x-x0)+fy(x=x0,y=y0)*(y-y0)
    show('(x_0,y_0)='+latex((x0,y0)))
    show('(f_x('+latex(x0)+'),f_y('+latex(y0)+'))='+latex((fx(x=x0,y=y0),fy(x=x0,y=y0))))
    show('L(x,y)='+latex(L(x=x,y=y)))
    show(plot3d(f,(x,-Mx,Mx),(y,-My,My),color='blue')+plot3d(L,(x,-Mx,Mx),(y,-My,My),color='red'))
</script></div>


<br>
Tangent plane to the implicitly defined surface in class:<br>
The tangent plane to \( z-yz^3=x+2\) at the point \((x_0,y_0,z_0)=(2,0,3)\): <br>
<div class="compute"><script type="text/x-sage">
x,y,z=var('x','y','z')
implicit_plot3d(z-y*z^3==x+2,(x,-4,4),(y,-4,4),(z,-4,4),color='blue')+\
implicit_plot3d(z==x+27*y+2,(x,-4,4),(y,-4,4),(z,-4,4),color='red')
</script></div>

<h2>Calculus VI : Directional derivative and gradient vectors</h2>

Here we plot the function
\[ f(x,y) = xy+y^2-x^3, \]
its level curves and the gradient vectors \(\nabla f\) (in red):<br><br>

<div class="compute"><script type="text/x-sage">
x,y=var('x','y')
M=1
f=x*y+y^2-x^3
#f=x*y
show('f(x,y)='+latex(f))
show(contour_plot(f,(x,-M,M),(y,-M,M),contours=30,fill=false)+\
     plot_vector_field(f.gradient(),(x,-M,M),(y,-M,M),color='red'))
show(plot3d(f,(x,-M,M),(y,-M,M)))
</script></div>
(You can uncomment the line <tt>f=x*y</tt> to plot \( f(x,y) = xy \),
or replace it with any function of your choice.)
<br><br>

For functions of three variables, the gradient vector is perpendicular to <thead>
  level surfaces of the function. We can use this to obtain an equation for
the tangent plane of a surface. <br><br>

For example, we compute the tangent plane
to the surface \( xy+yz^2+xz^3 = 54 \) at the point \( (2,0,3) \). <br>
This surface is a level surface of the function
\( f(x,y,z) = xy+yz^2+xz^3 \).
The gradient vector is then a normal vector for the surface, and we have a point
on the surface, and this lets us determine an equation for the
tangent surface:
\[
L : f_x(2,0,3)(x-2) + f_y(2,0,3)(y-0) + f_z(2,0,3)(z-3) = 0.
\]


<div class="compute"><script type="text/x-sage">
x,y,z = var('x','y','z')

f=x*y+y*z^2+x*z^3
(x0,y0,z0) = (2,0,3)

M=5
fx=diff(f,x)
fy=diff(f,y)
fz=diff(f,z)

L = fx(x=x0,y=y0,z=z0)*(x-x0)+fy(x=x0,y=y0,z=z0)*(y-y0)+fz(x=x0,y=y0,z=z0)*(z-z0)

show("f(x,y,z)="+latex(f))
show(r"\nabla f(x,y,z) = "+latex(f.gradient()))
show(r"(x_0,y_0,z_0) = "+latex((x0,y0,z0)))
show(r"\text{Tangent plane: }"+latex(L)+" = 0")

show(
    implicit_plot3d(f==f(x=x0,y=y0,z=z0),(x,-M,M),(y,-M,M),(z,-M,M),plot_points=100)+\
    implicit_plot3d(L==0,(x,-M,M),(y,-M,M),(z,-M,M),plot_points=100,color='red')+\
    sphere((x0,y0,z0),0.1,color='black')
)
</script></div>


<h2>Calculus VII: Global Minima and Maxima</h2>

The critical points of the function \( f(x,y) = 2x^3+(x+1)y^2+5x^2 \):
<div class="compute"><script type="text/x-sage">
x,y = var('x','y')
f=2*x^3+(x+1)*y^2+5*x^2
show("f(x,y) = "+latex(f))
show(
    plot3d(f,(x,-2,1),(y,-3,3),plot_points=100,aspect_ratio=[1,1,0.2])+\
    sphere((0,0,f(x=0,y=0)),0.1,color='red')+\
    sphere((-5/3,0,f(x=-5/3,y=0)),0.1,color='red')+\
    sphere((-1,2,f(x=-1,y=2)),0.1,color='red')+\
    sphere((-1,-2,f(x=-1,y=-2)),0.1,color='red')
)
show(
    contour_plot(f,(x,-2,1),(y,-3,3),plot_points=100,contours=40,fill=false)+\
    circle((0,0),0.01,color='red')+\
    circle((-5/3,0),0.01,color='red')+\
    circle((-1,2),0.01,color='red')+\
    circle((-1,-2),0.01,color='red')
)
</script></div>

<br><br>
Global maximum and minimum of \( f(x,y) = 2x^2+x+y^2-2 \) on the disc
\( D = \{ (x,y)\in\mathbb{R}^2 \;|\; x^2+y^2 \leq 4 \} \):
<div class="compute"><script type="text/x-sage">
r,t=var('r t')
parametric_plot3d((r*cos(t),r*sin(t),2*(r*cos(t))^2+r*cos(t)+(r*sin(t))^2-2),(t,0,2*pi),(r,0,2),
opacity=0.9,aspect_ratio=[1,1,0.3])+sphere((-1/4,0,-17/8),0.1,color='red')+sphere((2,0,8),0.1,color='red')
</script></div>


<h2>Calculus VIII: Chain Rules</h2>

The magic formula for implicit differentiation:
If \( f(x,y) = c \) defines \( y(x) \) implicitly as a function of \(x\), then
\[
\frac{dy}{dx} = -\frac{f_x}{f_y}.
\]
<div class="compute"><script type="text/x-sage">
x,y = var('x y')
M = 5

f = x*cos(y)+y*cos(x)-x

fx = diff(f,x)
fy = diff(f,y)

show(r"\frac{dy}{dy} = "+latex(-fx/fy))

@interact
def _(c=slider(-5,5,step_size=0.1,default=0),
    auto_update=true,
    slopes = true,
    gradient = false,
    show3d = false):
    show(r"f(x,y) = "+latex(f)+r" = "+latex(c))
    P = implicit_plot(f==c,(x,-M,M),(y,-M,M))
    if slopes:
        P=P+plot_slope_field(-fx/fy,(x,-M,M),(y,-M,M),plot_points=30,color='gray')
    if gradient:
        P=P+plot_vector_field(f.gradient(),(x,-M,M),(y,-M,M),plot_points=30,color='red')
    show(P)
    if show3d:
        show(plot3d(f,(x,-M,M),(y,-M,M),aspect_ratio=[1,1,0.5])+plot3d(c,(x,-M,M),(y,-M,M),opacity=0.5,color='pink'))
</script></div>

<h2>Your own computations</h2>
Type your own Sage computation below and click &ldquo;Evaluate&rdquo;.
    <div class="compute"><script type="text/x-sage">plot(sin(x), (x, 0, 2*pi))</script></div>
    <div class="compute"><script type="text/x-sage">
@interact
def f(n=(0,10)):
    print(2^n)
</script></div>
<br><br>
Is \(e^{\pi\sqrt{163}} \) an integer??<br><br>
<div class="compute"><script type="text/x-sage">
a=N(exp(pi*sqrt(163)),digits=30)
print(a.str(no_sci=2)[:30])
</script></div>
  </body>
</html>
